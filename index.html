<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell","ruby","php"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://support.magnr.com/hc/en-gb'>Support Desk</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Magnr Trading API. Technical details on how to implement and connect to our API is provided below.</p>

<h2 id="environments">Environments</h2>

<p>Magnr provides 2 separate environments for development and production. 
API pub/priv keys differ between the 2 environments so you will have to request one set from each environment separately.</p>

<p>All responses are of content type <code class="prettyprint">application/json</code></p>

<h3 id="production-environment">PRODUCTION ENVIRONMENT</h3>

<p>The Magnr production environment API is live and used by our own website <a href="#">https://magnr.com</a> .</p>

<ul>
<li>Production Site: <a href="#">https://magnr.com/</a></li>
<li>Production API : <a href="#">https://magnr.com/api/v1/</a></li>
</ul>

<h3 id="test-environment">TEST ENVIRONMENT</h3>

<p>All the examples of code in this documentation use the sandbox API in URLs. It is recommended that attempts to use the API are performed against sandbox before live.</p>

<ul>
<li>Sandbox Site: <a href="#">https://sandbox.magnr.com/</a></li>
<li>Sandbox API : <a href="#">https://sandbox.magnr.com/api/v1/</a></li>
</ul>

<p>The sandbox environment is connected to bitcoins testnet, consequently you can fund your account from one of many testnet faucets</p>

<ul>
<li><a href="http://faucet.haskoin.com/" target="_blank">http://faucet.haskoin.com/</a></li>
<li><a href="http://tpfaucet.appspot.com/" target="_blank">http://tpfaucet.appspot.com/</a></li>
<li><a href="https://testnet.coinfaucet.eu/en/" target="_blank">https://testnet.coinfaucet.eu/en/</a></li>
<li><a href="https://accounts.blockcypher.com/testnet-faucet" target="_blank">https://accounts.blockcypher.com/testnet-faucet</a></li>
</ul>

<aside class="notice">
In the SANDBOX environment it is advisable to utilise the &ldquo;LOCAL&rdquo; exchange and &ldquo;BTCUSD&rdquo; currency pair instead of the known production exchanges/pairs.
</aside>

<h2 id="error-handling">Error Handling</h2>

<blockquote>
<p>Example JSON Error</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"some error string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"another error string"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>All errors follow general REST principles. Included in the body of any error response (e.g. non-2xx status code) will be an error object of the form:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>errors</td>
<td>List of error strings</td>
</tr>
</tbody></table>

<h1 id="authentication">Authentication</h1>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nv">$privkey</span> <span class="o">=</span> <span class="s2">"your private key"</span><span class="p">;</span>
<span class="nv">$pubkey</span> <span class="o">=</span> <span class="s2">"your public key"</span><span class="p">;</span>

<span class="c1">// @note SET THIS DATA CORRECTLY ON EACH REQUEST AND BEFORE SIG AND AUTH GENERATION
</span><span class="nv">$data</span> <span class="o">=</span> <span class="s2">"empty string or json string"</span><span class="p">;</span>
<span class="nv">$tonce</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nb">microtime</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span>

<span class="nv">$sig</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">hash_hmac</span><span class="p">(</span><span class="s2">"sha512"</span><span class="p">,</span> <span class="nv">$tonce</span><span class="o">.</span><span class="nv">$pubkey</span><span class="o">.</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$privkey</span><span class="p">,</span> <span class="kc">true</span><span class="p">));</span>
<span class="nv">$auth</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$pubkey</span><span class="o">.</span><span class="s2">":"</span><span class="o">.</span><span class="nv">$sig</span><span class="p">);</span>
</code></pre>
<pre class="highlight shell"><code><span class="c"># With shell, you can pass a signed header with each request</span>
<span class="nv">TONCE</span><span class="o">=</span><span class="k">$(($(</span>date +%s<span class="k">)</span><span class="o">*</span><span class="m">1000</span><span class="k">))</span>
<span class="nv">PRIVKEY</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> -e <span class="s2">"your private key here"</span><span class="sb">`</span>
<span class="nv">PUBKEY</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> -e <span class="s2">"your public key here"</span><span class="sb">`</span>
<span class="nv">DATA</span><span class="o">=</span><span class="s2">"some json or empty string"</span>
<span class="nv">SIG</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> -en <span class="s2">"</span><span class="nv">$TONCE$PUBKEY$DATA</span><span class="s2">"</span> | openssl dgst -sha512 -hmac <span class="s2">"</span><span class="nv">$PRIVKEY</span><span class="s2">"</span> -binary | base64<span class="sb">`</span>
<span class="nv">AUTH</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> -en <span class="s2">"</span><span class="nv">$PUBKEY</span><span class="s2">:</span><span class="nv">$SIG</span><span class="s2">"</span> | base64<span class="sb">`</span>

curl <span class="s2">"https://sandbox.magnr.com/api/v1/&lt;some end point&gt;/"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Basic </span><span class="nv">$AUTH</span><span class="s2">"</span> <span class="se">\</span>
  -H <span class="s2">"Tonce: </span><span class="nv">$TONCE</span><span class="s2">"</span> <span class="se">\</span>
  -d <span class="nv">$DATA</span>

Note: The rest of the shell examples assume the shell variables TONCE and AUTH are regenerated per request.
</code></pre>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'uri'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'time'</span>
<span class="nb">require</span> <span class="s1">'securerandom'</span>
<span class="nb">require</span> <span class="s1">'base64'</span>

<span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com"</span><span class="p">)</span>
<span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">uri</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">uri</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>
<span class="n">http</span><span class="p">.</span><span class="nf">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>

<span class="n">pubkey</span> <span class="o">=</span> <span class="s2">"YOUR PUBLIC KEY"</span>
<span class="n">privkey</span> <span class="o">=</span> <span class="s2">"YOUR PRIVATE KEY"</span>

<span class="c1"># milliseconds time</span>
<span class="n">tonce</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_i</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="n">data</span> <span class="o">=</span> <span class="s2">""</span>
<span class="n">signature</span> <span class="o">=</span> <span class="no">Base64</span><span class="p">.</span><span class="nf">strict_encode64</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">digest</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'sha512'</span><span class="p">),</span> <span class="n">privkey</span><span class="p">,</span> <span class="n">tonce</span><span class="p">.</span><span class="nf">to_s</span><span class="o">+</span><span class="n">pubkey</span><span class="o">+</span><span class="n">data</span><span class="p">))</span>

<span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Get</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/api/v1/&lt;some end point&gt;/"</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'application/json'</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Tonce'</span><span class="p">,</span> <span class="n">tonce</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="n">pubkey</span><span class="p">,</span><span class="n">signature</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">response</span><span class="p">.</span><span class="nf">body</span>
</code></pre>

<p>We use pairs of long-lived application keys to authenticate requests. To request an API key log in to Magnr, click on Account Settings (In the Account menu drop-down) and select the API tab.</p>

<p>Every request should include the following header values</p>

<table><thead>
<tr>
<th>Header</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Tonce</td>
<td>yes</td>
<td>It should be a non-repeating number, and be around a 5 minutes window around the current timestamp. THIS TONCE NEEDS TO BE IN MILLISECONDS</td>
</tr>
<tr>
<td>Authorization</td>
<td>yes</td>
<td>The string &ldquo;Basic &rdquo;, appended with the signature resulting of calculating the HMAC SHA-512 value of the tonce, the public key that you were assigned, and the body of the request.</td>
</tr>
</tbody></table>

<aside class="notice">
TONCE NEEDS TO BE IN MILLISECONDS
</aside>

<h1 id="trading">Trading</h1>

<h2 id="create-trade">Create Trade</h2>
<pre class="highlight shell"><code><span class="nv">DATA</span><span class="o">=</span><span class="s2">"{</span><span class="se">\"</span><span class="s2">leverage</span><span class="se">\"</span><span class="s2">:10, </span><span class="se">\"</span><span class="s2">side</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">BUY</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">exchange</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">Bitfinex</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">pair</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">BTCUSD</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">stop_margin</span><span class="se">\"</span><span class="s2">:5, </span><span class="se">\"</span><span class="s2">size</span><span class="se">\"</span><span class="s2">:0.2, </span><span class="se">\"</span><span class="s2">take</span><span class="se">\"</span><span class="s2">:10}"</span>
curl <span class="s2">"https://sandbox.magnr.com/api/v1/trades/"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Basic </span><span class="nv">$AUTH</span><span class="s2">"</span> <span class="se">\</span>
  -H <span class="s2">"Tonce: </span><span class="nv">$TONCE</span><span class="s2">"</span> <span class="se">\</span>
  -d <span class="nv">$DATA</span>
</code></pre>

<p>Returns 201 CREATED when the trade is correctly placed. See error list for other response codes.</p>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">"leverage"</span><span class="o">=&gt;</span><span class="mi">10</span><span class="p">,</span> <span class="s2">"side"</span><span class="o">=&gt;</span><span class="s2">"buy"</span><span class="p">,</span> <span class="s2">"exchange"</span><span class="o">=&gt;</span><span class="s2">"Bitfinex"</span><span class="p">,</span> <span class="s2">"pair"</span><span class="o">=&gt;</span><span class="s2">"BTCUSD"</span><span class="p">,</span> <span class="s2">"stop_margin"</span><span class="o">=&gt;</span><span class="mi">5</span><span class="p">,</span> <span class="s2">"size"</span><span class="o">=&gt;</span><span class="mf">0.2</span><span class="p">,</span> <span class="s2">"take"</span><span class="o">=&gt;</span><span class="mi">10</span><span class="p">]);</span>

<span class="sd">/**
 * DO AUTH STUFF HERE TO GENERATE $auth AND $tonce
 */</span>

<span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com/api/v1/trades/"</span><span class="p">);</span>
<span class="c1">// Set to a POST request
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>

<span class="c1">// apply headers
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Authorization: Basic </span><span class="nv">$auth</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"Tonce: </span><span class="nv">$tonce</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"Content-Type: application/json"</span><span class="p">,</span> <span class="s2">"Accept: application/json"</span><span class="p">]);</span>

<span class="c1">// define how we want our response.
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// curl_exec returns the result
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// don't include headers in the response from curl_exec
</span>
<span class="c1">// gimme gimme!
</span><span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
<span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$body</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span> <span class="c1">// the json as an array
</span><span class="k">echo</span> <span class="s2">"STATUS: </span><span class="nv">$status</span><span class="se">\n</span><span class="s2">BODY:</span><span class="se">\n</span><span class="nv">$body</span><span class="s2">"</span><span class="p">;</span>
</code></pre>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'uri'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'time'</span>
<span class="nb">require</span> <span class="s1">'securerandom'</span>
<span class="nb">require</span> <span class="s1">'base64'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com"</span><span class="p">)</span>
<span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">uri</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">uri</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>
<span class="n">http</span><span class="p">.</span><span class="nf">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>

<span class="c1">#AUTHENTICATION HERE ... (see authentication section)</span>

<span class="n">pubkey</span> <span class="o">=</span> <span class="s2">"YOUR PRIVATE KEY"</span>
<span class="n">privkey</span> <span class="o">=</span> <span class="s2">"YOUR PUBLIC KEY"</span>

<span class="c1"># milliseconds time</span>
<span class="n">tonce</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_i</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="c1"># PLACE AN ORDER!</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="ss">:leverage</span> <span class="o">=&gt;</span><span class="mi">10</span><span class="p">,</span> <span class="ss">:side</span> <span class="o">=&gt;</span><span class="s2">"buy"</span><span class="p">,</span> <span class="ss">:exchange</span> <span class="o">=&gt;</span><span class="s2">"LOCAL"</span><span class="p">,</span> <span class="ss">:pair</span> <span class="o">=&gt;</span><span class="s2">"BTCUSD"</span><span class="p">,</span> <span class="ss">:stop_margin</span> <span class="o">=&gt;</span><span class="mi">5</span><span class="p">,</span> <span class="ss">:size</span> <span class="o">=&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="ss">:take</span> <span class="o">=&gt;</span><span class="mi">10</span><span class="p">}.</span><span class="nf">to_json</span>
<span class="n">signature</span> <span class="o">=</span> <span class="no">Base64</span><span class="p">.</span><span class="nf">strict_encode64</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">digest</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'sha512'</span><span class="p">),</span> <span class="n">privkey</span><span class="p">,</span> <span class="n">tonce</span><span class="p">.</span><span class="nf">to_s</span><span class="o">+</span><span class="n">pubkey</span><span class="o">+</span><span class="n">data</span><span class="p">))</span>

<span class="c1">##### END AUTH</span>

<span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/api/v1/trades/"</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'application/json'</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Tonce'</span><span class="p">,</span> <span class="n">tonce</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="n">pubkey</span><span class="p">,</span><span class="n">signature</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">body</span> <span class="o">=</span> <span class="n">data</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="n">json</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">json</span>
</code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST /api/v1/trades/</code></p>

<h3 id="body-parameters">BODY Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>side</td>
<td>string</td>
<td>YES</td>
<td>none</td>
<td>buy or sell (case sensitive)</td>
</tr>
<tr>
<td>size</td>
<td>float</td>
<td>YES</td>
<td>none</td>
<td>Size of the position to market.</td>
</tr>
<tr>
<td>exchange</td>
<td>string</td>
<td>YES</td>
<td>none</td>
<td>Bitstamp,ItBit,Bitfinex (Exchange to be used for the trade)</td>
</tr>
<tr>
<td>pair</td>
<td>string</td>
<td>YES</td>
<td>none</td>
<td>BTCUSD, XBTUSD (exchange dependent)</td>
</tr>
<tr>
<td>leverage</td>
<td>number</td>
<td>NO</td>
<td>10</td>
<td>10,5,2 (Leverage to apply on this trade)</td>
</tr>
<tr>
<td>stop_margin</td>
<td>float</td>
<td>NO</td>
<td>max stop for deposit</td>
<td>An amount in $USD the price can move against you before being automatically closed out.</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>NO</td>
<td>market</td>
<td>market is the only option at present</td>
</tr>
<tr>
<td>take</td>
<td>float</td>
<td>NO</td>
<td>none</td>
<td>The amount in $USD you wish the price to move in your favour before closing out.</td>
</tr>
</tbody></table>

<blockquote>
<p>Example response - 201 CREATED</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="mi">1234</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="response">RESPONSE</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>Trade identifier</td>
</tr>
</tbody></table>

<h3 id="errors">ERRORS</h3>

<table><thead>
<tr>
<th>Response</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400 Bad Request</td>
<td>The request parameters were missing or incorrect</td>
</tr>
<tr>
<td>409 Conflict</td>
<td>The request could be completed due to a state conflict with the account</td>
</tr>
<tr>
<td>500 Internal Server Error</td>
<td>The system encountered an error, or the exchange failed to accept the trade</td>
</tr>
</tbody></table>

<h2 id="list-trades">List Trades</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://sandbox.magnr.com/api/v1/trades/"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  -H <span class="s2">"Accept: application/json"</span>
  -H <span class="s2">"Authorization: Basic </span><span class="nv">$AUTH</span><span class="s2">"</span>
  -H <span class="s2">"Tonce: &lt;tonce&gt;"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

<span class="sd">/**
 * DO AUTH STUFF HERE TO SET $auth AND $tonce
 */</span>

<span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com/api/v1/trades/"</span><span class="p">);</span>
<span class="c1">// apply headers
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Authorization: Basic </span><span class="nv">$auth</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"Tonce: </span><span class="nv">$tonce</span><span class="s2">"</span><span class="p">]);</span>

<span class="c1">// define how we want our response.
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// curl_exec returns the result
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// don't include headers in the response from curl_exec
</span>
<span class="c1">// gimme gimme!
</span><span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
<span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="k">echo</span> <span class="s2">"STATUS: </span><span class="nv">$status</span><span class="se">\n</span><span class="s2">BODY:</span><span class="se">\n</span><span class="nv">$body</span><span class="s2">"</span><span class="p">;</span>
</code></pre>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'uri'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'time'</span>
<span class="nb">require</span> <span class="s1">'securerandom'</span>
<span class="nb">require</span> <span class="s1">'base64'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com"</span><span class="p">)</span>
<span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">uri</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">uri</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>
<span class="n">http</span><span class="p">.</span><span class="nf">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>

<span class="c1">#AUTHENTICATION HERE ... (see authentication section)</span>

<span class="n">pubkey</span> <span class="o">=</span> <span class="s2">"YOUR PRIVATE KEY"</span>
<span class="n">privkey</span> <span class="o">=</span> <span class="s2">"YOUR PUBLIC KEY"</span>

<span class="c1"># milliseconds time</span>
<span class="n">tonce</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_i</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="n">data</span> <span class="o">=</span> <span class="s2">""</span>
<span class="n">signature</span> <span class="o">=</span> <span class="no">Base64</span><span class="p">.</span><span class="nf">strict_encode64</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">digest</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'sha512'</span><span class="p">),</span> <span class="n">privkey</span><span class="p">,</span> <span class="n">tonce</span><span class="p">.</span><span class="nf">to_s</span><span class="o">+</span><span class="n">pubkey</span><span class="o">+</span><span class="n">data</span><span class="p">))</span>

<span class="c1">##### END AUTH</span>

<span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Get</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/api/v1/trades/"</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'application/json'</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Tonce'</span><span class="p">,</span> <span class="n">tonce</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="n">pubkey</span><span class="p">,</span><span class="n">signature</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="n">json</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">json</span>
</code></pre>

<blockquote>
<p>Response - 200 OK</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"trades"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
        </span><span class="nt">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="nt">"size"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"deposit"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.002</span><span class="p">,</span><span class="w">
        </span><span class="nt">"exchange"</span><span class="p">:</span><span class="s2">"LOCAL"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created_at"</span><span class="p">:</span><span class="mi">1444251389</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_price"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_price"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed_reason"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trade_rate"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.48</span><span class="p">,</span><span class="w">
        </span><span class="nt">"daily_rate"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trades_fees"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.004</span><span class="p">,</span><span class="w">
        </span><span class="nt">"daily_fees"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"profit"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="mi">1233</span><span class="p">,</span><span class="w">
        </span><span class="nt">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sell"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nt">"size"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"deposit"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.008</span><span class="p">,</span><span class="w">
        </span><span class="nt">"exchange"</span><span class="p">:</span><span class="s2">"LOCAL"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created_at"</span><span class="p">:</span><span class="mi">1444230624</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed_at"</span><span class="p">:</span><span class="mi">1444612316</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">234.45</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">235.56</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed_reason"</span><span class="p">:</span><span class="s2">"stop"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trade_rate"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.48</span><span class="p">,</span><span class="w">
        </span><span class="nt">"daily_rate"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trades_fees"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.002</span><span class="p">,</span><span class="w">
        </span><span class="nt">"daily_fees"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0009</span><span class="p">,</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"settled"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"profit"</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.00000667</span><span class="w">
      </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET /api/v1/trades/</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<p><code class="prettyprint">NONE</code></p>

<h3 id="response">RESPONSE</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>trades</td>
<td>array</td>
<td>An array of trade objects (see <a href="#get-trade">Get Trade</a> call)</td>
</tr>
</tbody></table>

<h2 id="get-trade">Get Trade</h2>
<pre class="highlight shell"><code><span class="nv">ID</span><span class="o">=</span>1234
// regenerate TONCE and AUTH
curl <span class="s2">"https://sandbox.magnr.com/api/v1/trades/</span><span class="nv">$ID</span><span class="s2">/"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  -H <span class="s2">"Accept: application/json"</span>
  -H <span class="s2">"Authorization: Basic </span><span class="nv">$AUTH</span><span class="s2">"</span>
  -H <span class="s2">"Tonce: </span><span class="nv">$TONCE</span><span class="s2">"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>

<span class="nv">$id</span> <span class="o">=</span> <span class="mi">1234</span><span class="p">;</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

<span class="sd">/**
 * DO AUTH STUFF HERE TO SET $auth AND $tonce
 */</span>

<span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com/api/v1/trades/</span><span class="nv">$id</span><span class="s2">/"</span><span class="p">);</span>
<span class="c1">// apply headers
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Authorization: Basic </span><span class="nv">$auth</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"Tonce: </span><span class="nv">$tonce</span><span class="s2">"</span><span class="p">]);</span>

<span class="c1">// define how we want our response.
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// curl_exec returns the result
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// don't include headers in the response from curl_exec
</span>
<span class="c1">// gimme gimme!
</span><span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
<span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="k">echo</span> <span class="s2">"STATUS: </span><span class="nv">$status</span><span class="se">\n</span><span class="s2">BODY:</span><span class="se">\n</span><span class="nv">$body</span><span class="s2">"</span><span class="p">;</span>
</code></pre>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'uri'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'time'</span>
<span class="nb">require</span> <span class="s1">'securerandom'</span>
<span class="nb">require</span> <span class="s1">'base64'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com"</span><span class="p">)</span>
<span class="n">http</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">uri</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">uri</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span>
<span class="n">http</span><span class="p">.</span><span class="nf">use_ssl</span> <span class="o">=</span> <span class="kp">true</span>

<span class="c1">#AUTHENTICATION HERE ... (see authentication section)</span>

<span class="n">pubkey</span> <span class="o">=</span> <span class="s2">"YOUR PRIVATE KEY"</span>
<span class="n">privkey</span> <span class="o">=</span> <span class="s2">"YOUR PUBLIC KEY"</span>

<span class="c1"># milliseconds time</span>
<span class="n">tonce</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_i</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="n">data</span> <span class="o">=</span> <span class="s2">""</span>
<span class="n">signature</span> <span class="o">=</span> <span class="no">Base64</span><span class="p">.</span><span class="nf">strict_encode64</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">digest</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'sha512'</span><span class="p">),</span> <span class="n">privkey</span><span class="p">,</span> <span class="n">tonce</span><span class="p">.</span><span class="nf">to_s</span><span class="o">+</span><span class="n">pubkey</span><span class="o">+</span><span class="n">data</span><span class="p">))</span>

<span class="c1">##### END AUTH</span>

<span class="n">request</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Get</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/api/v1/trades/</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'application/json'</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'Tonce'</span><span class="p">,</span> <span class="n">tonce</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="n">pubkey</span><span class="p">,</span><span class="n">signature</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="n">json</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">json</span>
</code></pre>

<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"trade"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
    </span><span class="nt">"side"</span><span class="p">:</span><span class="w"> </span><span class="s2">"buy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"leverage"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"size"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"deposit"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.002</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exchange"</span><span class="p">:</span><span class="s2">"LOCAL"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="mi">1444230624</span><span class="p">,</span><span class="w">
    </span><span class="nt">"closed_at"</span><span class="p">:</span><span class="mi">1444612316</span><span class="p">,</span><span class="w">
    </span><span class="nt">"open_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">234.45</span><span class="p">,</span><span class="w">
    </span><span class="nt">"close_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">235.56</span><span class="p">,</span><span class="w">
    </span><span class="nt">"closed_reason"</span><span class="p">:</span><span class="s2">"user"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trade_rate"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.48</span><span class="p">,</span><span class="w">
    </span><span class="nt">"daily_rate"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trades_fees"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.004</span><span class="p">,</span><span class="w">
    </span><span class="nt">"daily_fees"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"settled"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"profit"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00019382</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves a specific trade.</p>

<h3 id="http-request">HTTP REQUEST</h3>

<p><code class="prettyprint">GET /api/v1/trades/:id/</code></p>

<h3 id="url-parameters">URL PARAMETERS</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>YES</td>
<td>The ID of the trade to retrieve</td>
</tr>
</tbody></table>

<h3 id="response">RESPONSE</h3>

<p>Returns a Trade object </p>

<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>id of the trade</td>
</tr>
<tr>
<td>side</td>
<td>string</td>
<td>&ldquo;buy&rdquo; or &ldquo;sell&rdquo;</td>
</tr>
<tr>
<td>leverage</td>
<td>int</td>
<td>the leverage applied on the trade</td>
</tr>
<tr>
<td>size</td>
<td>float</td>
<td>size of the trade at market</td>
</tr>
<tr>
<td>deposit</td>
<td>float</td>
<td>size of the deposit taken for the trade</td>
</tr>
<tr>
<td>exchange</td>
<td>string</td>
<td>the name of the exchange that the trade was opened on</td>
</tr>
<tr>
<td>created_at</td>
<td>int</td>
<td>timestamp of trade creation (in seconds since epoch)</td>
</tr>
<tr>
<td>closed_at</td>
<td>int</td>
<td>timestamp of the trade close (in seconds since epoch)</td>
</tr>
<tr>
<td>open_price</td>
<td>float</td>
<td>price the trade was opened at</td>
</tr>
<tr>
<td>close_price</td>
<td>float</td>
<td>price the trade closed at</td>
</tr>
<tr>
<td>closed_reason</td>
<td>string</td>
<td>the reason the trade closed (user,stop,limit,insufficient funds)</td>
</tr>
<tr>
<td>trade_rate</td>
<td>float</td>
<td>trade charge PERCENTAGE (e.g. 0.48%)</td>
</tr>
<tr>
<td>daily_rate</td>
<td>float</td>
<td>daily charge PERCENTAGE (e.g. 0.2%)</td>
</tr>
<tr>
<td>trade_fees</td>
<td>float</td>
<td>bitcoin trade fees (absolute) applied to the trade (note: this includes BOTH open AND close fees)</td>
</tr>
<tr>
<td>daily_fees</td>
<td>float</td>
<td>bitcoin daily fees (absolute) applied to the trade since it was opened</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>the state of the trade (<strong>pending</strong> -&gt; <strong>open</strong> -&gt; <strong>closed</strong> -&gt; <strong>settled</strong>), see status info.</td>
</tr>
<tr>
<td>profit</td>
<td>float</td>
<td>the profit on the trade if it has settled, otherwise NULL</td>
</tr>
<tr>
<td>stop_margin</td>
<td>float</td>
<td>size in currency (e.g. USD) of the stop margin</td>
</tr>
<tr>
<td>trail_margin</td>
<td>float</td>
<td>size in currency (e.g. USD) of the trailing stop, otherwise NULL if not set</td>
</tr>
<tr>
<td>sell_limit</td>
<td>float</td>
<td>size in currency (e.g. USD) of the sell limit, otherwise NULL if not set</td>
</tr>
</tbody></table>

<h3 id="status">STATUS</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>pending</td>
<td>The trade has been placed at the exchange but is awaiting fill (i.e. open price is NULL).</td>
</tr>
<tr>
<td>open</td>
<td>The trade has been filled and now has an open price</td>
</tr>
<tr>
<td>closed</td>
<td>The trade has been closed either by user or system but it awaiting a closing price (i.e. close price is NULL).</td>
</tr>
<tr>
<td>settled</td>
<td>The trade has been filled at a close price and now has a profit, all deposits should have been refunded.</td>
</tr>
</tbody></table>

<h3 id="closed-reason">CLOSED REASON</h3>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user</td>
<td>You (the user) have requested the trade be closed.</td>
</tr>
<tr>
<td>stop</td>
<td>The trade has reached the stop margin specified, and it has been automatically closed.</td>
</tr>
<tr>
<td>trail</td>
<td>The trade has reached the trail margin specified, and it has been automatically closed.</td>
</tr>
<tr>
<td>limit</td>
<td>The trade has reached the target sell limit, and has been automatically closed.</td>
</tr>
<tr>
<td>insufficient funds</td>
<td>A healthly balance was NOT maintained and a daily charge would not be applied, as a result the trade has been automatically closed.</td>
</tr>
</tbody></table>

<h3 id="errors">ERRORS</h3>

<table><thead>
<tr>
<th>Response</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400 Bad Request</td>
<td>The request parameters were missing or incorrect</td>
</tr>
<tr>
<td>404 Not Found</td>
<td>The trade you requested does not exist</td>
</tr>
<tr>
<td>500 Internal Server Error</td>
<td>The system encountered an error</td>
</tr>
</tbody></table>

<h2 id="liquidate-close-trade">Liquidate (Close) Trade</h2>
<pre class="highlight shell"><code><span class="nv">ID</span><span class="o">=</span>1234
// regenerate TONCE and AUTH
curl <span class="s2">"https://sandbox.magnr.com/api/v1/trades/</span><span class="nv">$ID</span><span class="s2">/"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  -H <span class="s2">"Accept: application/json"</span>
  -H <span class="s2">"Authorization: Basic </span><span class="nv">$AUTH</span><span class="s2">"</span>
  -H <span class="s2">"Tonce: </span><span class="nv">$TONCE</span><span class="s2">"</span>
</code></pre>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nv">$id</span> <span class="o">=</span> <span class="mi">1234</span><span class="p">;</span>
<span class="nv">$data</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

<span class="sd">/**
 * DO AUTH STUFF HERE TO SET $auth AND $tonce
 */</span>

<span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="s2">"https://sandbox.magnr.com/api/v1/trades/</span><span class="nv">$id</span><span class="s2">/"</span><span class="p">);</span>

<span class="c1">// DELETE REQUEST TYPE
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"DELETE"</span><span class="p">);</span>

<span class="c1">// apply headers
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="p">[</span><span class="s2">"Authorization: Basic </span><span class="nv">$auth</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"Tonce: </span><span class="nv">$tonce</span><span class="s2">"</span><span class="p">]);</span>

<span class="c1">// define how we want our response.
</span><span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="c1">// gimme gimme!
</span><span class="nv">$body</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
<span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>

<span class="k">echo</span> <span class="s2">"STATUS: </span><span class="nv">$status</span><span class="se">\n</span><span class="s2">BODY:</span><span class="se">\n</span><span class="nv">$body</span><span class="s2">"</span><span class="p">;</span>
</code></pre>

<blockquote>
<p>Example Response - 200 OK</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="mi">1234</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP REQUEST</h3>

<p><code class="prettyprint">DELETE /api/v1/trades/:id/</code></p>

<h3 id="url-parameters">URL PARAMETERS</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>yes</td>
<td>The ID of the trade to liquidate/close</td>
</tr>
</tbody></table>

<h3 id="response">RESPONSE</h3>

<p>Returns a identity object indicating the ID of the liquidated position.</p>

<h3 id="errors">ERRORS</h3>

<table><thead>
<tr>
<th>Response</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>404 Not Found</td>
<td>The trade you requested to delete does not exist.</td>
</tr>
<tr>
<td>409 Conflict</td>
<td>The trade is in an invalid state (possibly still pending)</td>
</tr>
<tr>
<td>500 Internal Server Error</td>
<td>The system encountered an error</td>
</tr>
<tr>
<td>504 Gateway Timeout</td>
<td>The exchange encountered an issue and could not complete the request.</td>
</tr>
</tbody></table>

<h1 id="price-data">Price Data</h1>

<h2 id="exchange-pricing">Exchange Pricing</h2>

<p>For the lowest latency, we recommend using price data direct from the exchanges we connect with. This will allow for better pricing data to be fed directly into your trading scripts. Magnr&rsquo;s position execution policy is at-best market price. Frequent price updates will result in execution prices closer to market prices.</p>

<h3 id="bitfinex">Bitfinex</h3>

<ul>
<li>Bitfinex: <a href="https://api.bitfinex.com/v1/pubticker/BTCUSD">https://api.bitfinex.com/v1/pubticker/BTCUSD</a></li>
</ul>

<p><a href='http://docs.bitfinex.com/#rest'>Bitfinex Documentation</a></p>

<h3 id="bitstamp">Bitstamp</h3>

<ul>
<li>Bitstamp: <a href="https://www.bitstamp.net/api/ticker/">https://www.bitstamp.net/api/ticker/</a></li>
</ul>

<p><a href='https://www.bitstamp.net/api/'>Bitstamp Documentation</a></p>

<h3 id="itbit">ItBit</h3>

<ul>
<li>ItBit: <a href="https://api.itbit.com/v1/markets/XBTUSD/ticker">https://api.itbit.com/v1/markets/XBTUSD/ticker</a></li>
</ul>

<p><a href='https://api.itbit.com/docs'>ItBit Documentation</a></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
